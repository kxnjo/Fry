{% extends "index.html" %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center">
        <h2>User Management</h2>
        
        <!-- Search and Filter Form -->
        <form class="form-inline" method="GET" action="/admin/search_users">
            <div class="input-group">
                <input type="text" class="form-control" name="search" placeholder="Search users...">
                <button type="submit" class="btn btn-primary">Search</button>
                <button type="button" class="btn btn-secondary ml-2">Filter</button>
            </div>
        </form>
    </div>

    <!-- Create User Form -->
    <form id="create-user-form" method="POST" action="/admin/create_user">
        <!-- Form fields here -->
    </form>

    <!-- User Table -->
    <table class="table table-striped mt-4">
        <thead>
            <tr>
                <th scope="col">UID</th>
                <th scope="col">Username</th>
                <th scope="col">Email</th>
                <th scope="col">Date Created</th>
                <th scope="col">Role</th>
                <th scope="col">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for user in users %}
            <tr>
                <td>{{ user.user_id }}</td>
                <td>{{ user.username }}</td>
                <td>{{ user.email }}</td>
                <td>{{ user.created_on }}</td>
                <td>{{ user.role }}</td>
                <td>
                    <!-- Edit User Form -->
                    <a type="submit" href="{{url_for('user_bp.edit_user', user_id=user.user_id) }}" class="btn btn-warning btn-sm d-inline">Edit</a>
                    
                    <!-- Delete User Form -->
                    <a type="submit" href="{{url_for('user_bp.delete_user', user_id=user.user_id) }}" class="btn btn-danger btn-sm d-inline">Delete</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Pagination Controls -->
    <nav aria-label="Page navigation">
        <ul class="pagination">
            <!-- Previous Page Button -->
            <li class="page-item {% if page <= 1 %}disabled{% endif %}">
                <a class="page-link" href="{{ url_for('user_bp.dashboard', page=page-1) }}" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>

            <!-- Page Number Buttons -->
            {% for p in range(1, total_pages + 1) %}
            <li class="page-item {% if p == page %}active{% endif %}">
                <a class="page-link" href="{{ url_for('user_bp.dashboard', page=p) }}">{{ p }}</a>
            </li>
            {% endfor %}

            <!-- Next Page Button -->
            <li class="page-item {% if page >= total_pages %}disabled{% endif %}">
                <a class="page-link" href="{{ url_for('user_bp.dashboard', page=page+1) }}" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        </ul>
    </nav>
</div>
{% endblock %}
