{% extends "index.html" %}
{% block content %}
<div class="container mt-5">
    <div class="row">
        <!-- Game Details Section -->
        <div class="col-md-8">
            <h1>{{ game.game_title }}</h1>
            <h5><strong>Developed By:</strong>
                {% for developer in game.developers %}
                <a href="{{ url_for('developer_bp.view_developer', developer_id=developer.developer_id) }}"
                   class="text-decoration-none">
                    {{ developer }}{% if not loop.last %}, {% endif %}
                </a>
                {% endfor %}
            </h5>
            <h5><strong>Release Date:</strong> {{ game.game_release_date }}</h5>
            <h5><strong>Price:</strong> ${{ game.game_price }}</h5>
            <h5><strong>Categories:</strong>
                {% if game.categories %}
                    {% for category in game.categories %}
                        <!-- <a href="{{ url_for('category_bp.view_category', category_id=category.category_id) }}" class="text-decoration-none"></a> -->
                           
                            {{ category}}{% if not loop.last %}, {% endif %}
                        <!-- </a> -->
                    {% endfor %}
                {% else %}
                    <div class="alert alert-warning" role="alert">
                        No categories found.
                    </div>
                {% endif %}
            </h5>
        </div>

        <!-- Buttons Section -->
        <div class="col-md-4 d-flex flex-column">
            <div class="d-flex align-items-center">
                <img src="{{ game.image if game.image else url_for('static', filename='img/default_game.jpeg') }}" 
                     class="rounded me-3" style="width: 360px; height: 204px; object-fit: cover;"
                     alt="{{ game.title }}">
            </div>
            <br>
            <div class="mt-auto"> <!-- Align to bottom -->
                <!-- Temporary add to wishlist and purchase button -->
                <form method="POST" action="{{ url_for('wishlist_bp.addToWishlist') }}" class="mb-2">
                    <input type="text" name="game_id" value="{{ game.game_id }}" hidden>
                    <button type="submit" class="btn btn-light" style="width: 210px;">Add to Wishlist</button>
                </form>
                <form method="POST" action="{{ url_for('owned_game_bp.add_owned_game') }}">
                    <input type="text" name="game" value="{{ game.game_id }}" hidden>
                    <button type="submit" class="btn btn-light" style="width: 210px;">Purchase</button>
                </form>   
            {% if user_logged_in %}
            <!-- Actual add to wishlist and purchase button but need update the backend -->
            <div class="d-flex flex-column">
                <form method="POST" action="{{ url_for('wishlist_bp.addToWishlist') }}" class="mb-2">
                    <input type="text" name="game_id" value="{{ game.game_id }}" hidden>
                    <button type="submit" class="btn btn-light" style="width: 210px;"
                            {% if gameInWishlist %} disabled {% endif %}>
                        {% if gameInWishlist %} Already Added to Wishlist
                        {% else %} Add to Wishlist
                        {% endif %}
                    </button>
                </form>
                {% if user_owned %}
                <a href="{{ url_for('owned_game_bp.delete_owned_game', game_id=game.game_id) }}"
                    class="btn btn-danger" style="width: 210px; ">Delete</a>
                {% else %}
                <form method="POST" action="{{ url_for('owned_game_bp.add_owned_game') }}">
                    <input type="text" name="game" value="{{ game.game_id }}" hidden>
                    <button type="submit" class="btn btn-light" style="width: 210px;">Purchase</button>
                </form>                
                {% endif %}
            </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>


{% endblock %}
